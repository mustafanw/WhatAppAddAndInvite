import ast
import pymysql

import psycopg2

conn = psycopg2.connect(host="ec2-23-20-208-173.compute-1.amazonaws.com",
                            port="5432",
                            user="wtgfwfsrmdtsxf",
                            password="7023c8b48035cf5f07a3a56b72e806e52cdbeb00228849038a4b4430cbfeb9b9",
                            database="d3d94oi1klcln2",
                            )
sql='create table if NOT EXISTS whatsapp_users( id serial, phone_number character varying primary key, message_sent character varying);'
cur = conn.cursor()
# cur.execute(sql)
# conn.commit()
# cur.close()
a='<span title="+1 (218) 450-8522, +1 (343) 304-0351, +1 (530) 475-4574, +1 (587) 318-2340, +1 (912) 405-1435, +234 802 982 8328, +234 901 971 8748, +48 45 906 50 01, +880 1716-333648, +880 1914-230405, +91 6200 201 247, +91 6235 165 551, +91 6281 215 370, +91 6299 246 971, +91 6350 217 052, +91 6352 100 531, +91 6372 813 429, +91 6396 095 732, +91 70003 10560, +91 70063 39006, +91 70613 30363, +91 70674 48195, +91 70689 83821, +91 70967 18234, +91 70968 17910, +91 72188 41298, +91 73027 02389, +91 73178 33286, +91 73397 27326, +91 73544 25437, +91 73750 78802, +91 73796 93027, +91 74339 50113, +91 74783 29915, +91 74860 26033, +91 75672 09123, +91 76670 34654, +91 77383 35513, +91 77396 18825, +91 77440 10232, +91 77680 12143, +91 77700 78607, +91 77749 37137, +91 77965 58791, +91 78619 44951, +91 78630 94591, +91 78746 38305, +91 78808 35925, +91 79009 54344, +91 79773 19894, +91 79880 03979, +91 80001 31327, +91 80068 87270, +91 80184 72398, +91 80548 93039, +91 80725 89264, +91 81236 95489, +91 81550 86026, +91 81759 93306, +91 81800 42167, +91 82006 15063, +91 82185 89868, +91 82475 78932, +91 82756 67944, +91 82830 88850, +91 82912 58646, +91 82916 74664, +91 82951 51594, +91 82996 51199, +91 83095 42098, +91 83170 70359, +91 83559 82403, +91 83684 28887, +91 84211 30337, +91 84240 58311, +91 85110 01140, +91 85608 48058, +91 86059 54420, +91 86194 89994, +91 86238 63923, +91 86589 38823, +91 86701 14050, +91 87083 24264, +91 87268 78434, +91 87675 14268, +91 87923 38813, +91 87975 66961, +91 88278 08190, +91 88377 32984, +91 88513 48405, +91 89214 21506, +91 89512 02010, +91 89676 34276, +91 90228 60406, +91 90232 81205, +91 90286 93539, +91 90341 59752, +91 90568 48482, +91 90746 83821, +91 90987 83097, +91 91048 58715, +91 91052 08122, +91 91062 55205, +91 91154 41051, +91 91326 70940, +91 91377 65080, +91 91565 41714, +91 92146 96040, +91 93062 82438, +91 93365 67134, +91 93391 59166, +91 93594 41779, +91 93816 43625, +91 93842 78212, +91 94090 37533, +91 94465 95850, +91 94684 48184, +91 94789 09407, +91 94832 15555, +91 94915 20657, +91 95094 99667, +91 95112 74602, +91 95261 06645, +91 95325 31739, +91 95376 50789, +91 95412 70493, +91 95579 19219, +91 95602 65818, +91 95631 56970, +91 95893 23997, +91 96107 84707, +91 96133 34000, +91 96170 96763, +91 96198 07633, +91 96329 42874, +91 96389 24297, +91 96443 72633, +91 96545 90084, +91 96571 03118, +91 96607 53849, +91 96870 32500, +91 97041 32034, +91 97170 84494, +91 97171 54817, +91 97297 20589, +91 97872 48673, +91 98113 73665, +91 98290 63290, +91 98331 26452, +91 98507 44068, +91 98663 02920, +91 98667 45900, +91 98767 40081, +91 98880 50203, +91 98882 35408, +91 98962 03256, +91 99046 25501, +91 99111 16200, +91 99558 45004, +91 99575 68621, +91 99628 67067, +91 99679 65260, +91 99853 54180, +91 99874 88855, +91 99887 98686, +91 99921 10179, +92 312 1421888, +92 331 3679875, +92 346 7410695, +961 81 725 589"</span>'
a=a.replace('<span title="',"")
a=a.replace('"</span>','')
a=a.replace(' ','')
a=a.replace(',You','')
a=a.replace(',','","')
a=a.replace('+91','')
a=a.replace('class="_3Id9P_1VzZY">',',"')
a='["'+a+'"]'
a=ast.literal_eval(a)
print(a)
users=list()
for user in a:
    if "+" in user:
        pass
    else:
        users.append((user,"false"))

sql='INSERT INTO whatsapp_users(phone_number,message_sent) VALUES(%s,%s) ON CONFLICT DO NOTHING'
cur.executemany(sql, users)
conn.commit()
cur.close()
# print(users)
# db = pymysql.connect("remotemysql.com","oCtHbs37t9","Ifvu2JOuDf","oCtHbs37t9",charset='utf8' )
# cursor = db.cursor()
# cursor.executemany("""INSERT IGNORE INTO whatsapp_users(phone_number,message_sent) VALUES(%s,%s)""", users)
# db.commit()
#create table if NOT EXISTS whatsapp_users( id int AUTO_INCREMENT NOT null, phone_number VARCHAR(100) UNIQUE NOT NULL, message_sent VARCHAR(50),primary key (id));
